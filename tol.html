<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas & Ink - Explore Countries</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'scale-in': 'scaleIn 0.3s ease-out'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.9)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="app">
        <!-- Header Component -->
        <header-component 
            :search-query="searchQuery"
            @search-change="handleSearchChange"
            @search="handleSearch"
        ></header-component>
        
        <!-- Main Content -->
        <main class="py-12">
            <div class="max-w-7xl mx-auto px-4">
                <!-- Loading State -->
                <div v-if="loading" class="text-center text-white text-xl mb-8 animate-pulse">
                    <div class="text-6xl mb-4">üåç</div>
                    Loading countries...
                </div>

                <!-- Error State -->
                <div v-if="error" class="text-center text-red-300 bg-red-500/10 backdrop-blur-sm p-6 rounded-2xl mb-8 border border-red-500/20">
                    <div class="text-4xl mb-2">‚ùå</div>
                    {{ error }}
                </div>

                <!-- No Results -->
                <div v-if="!loading && !error && filteredCountries.length === 0" class="text-center text-white bg-white/10 backdrop-blur-sm p-12 rounded-3xl border border-white/20">
                    <h3 class="text-2xl font-bold mb-4">üîç No countries found</h3>
                    <p class="text-lg opacity-80">
                        Try searching with a different keyword or clear the search to see all countries.
                    </p>
                </div>

                <!-- Countries Grid -->
                <div v-if="!loading && !error && filteredCountries.length > 0">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12">
                        <country-card
                            v-for="country in paginatedCountries"
                            :key="country.cca3"
                            :country="country"
                            @show-details="showCountryDetails"
                            class="animate-slide-up"
                        ></country-card>
                    </div>

                    <!-- Pagination -->
                    <pagination-component
                        :current-page="currentPage"
                        :total-pages="totalPages"
                        :total-items="filteredCountries.length"
                        :items-per-page="itemsPerPage"
                        @page-change="handlePageChange"
                    ></pagination-component>
                </div>
            </div>
        </main>

        <!-- Modal -->
        <country-modal
            :country="selectedCountry"
            :is-open="showModal"
            @close="closeModal"
        ></country-modal>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;

        // Types (simulated in JavaScript with JSDoc)
        /**
         * @typedef {Object} CountryName
         * @property {string} common
         * @property {string} official
         */

        /**
         * @typedef {Object} CountryFlags
         * @property {string} svg
         * @property {string} png
         */

        /**
         * @typedef {Object} Currency
         * @property {string} name
         * @property {string} [symbol]
         */

        /**
         * @typedef {Object} CountryMaps
         * @property {string} [googleMaps]
         */

        /**
         * @typedef {Object} Country
         * @property {string} cca3
         * @property {CountryName} name
         * @property {CountryFlags} flags
         * @property {string} region
         * @property {string} [subregion]
         * @property {number} population
         * @property {Object<string, string>} [languages]
         * @property {Object<string, Currency>} [currencies]
         * @property {string[]} timezones
         * @property {string[]} [capital]
         * @property {CountryMaps} maps
         */

        // Header Component
        const HeaderComponent = {
            props: {
                searchQuery: {
                    type: String,
                    required: true
                }
            },
            emits: ['search-change', 'search'],
            template: `
                <header class="bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-48 h-48 opacity-20 text-8xl flex items-center justify-center">
                        üß≥
                    </div>
                    
                    <div class="max-w-7xl mx-auto px-4 py-8 relative z-10">
                        <!-- Navigation -->
                        <nav class="flex justify-between items-center mb-8">
                            <div class="text-2xl font-bold text-gray-800">Atlas & Ink</div>
                            <ul class="flex gap-8">
                                <li><a href="#home" class="text-gray-700 hover:text-gray-900 font-medium transition-colors duration-200">Home</a></li>
                                <li><a href="#explore" class="text-gray-700 hover:text-gray-900 font-medium transition-colors duration-200">Explore</a></li>
                                <li><a href="#about" class="text-gray-700 hover:text-gray-900 font-medium transition-colors duration-200">About Us</a></li>
                            </ul>
                        </nav>
                        
                        <!-- Hero Section -->
                        <div class="text-center">
                            <h1 class="text-3xl md:text-5xl font-bold text-gray-800 mb-4">Explore Countries</h1>
                            <p class="text-lg md:text-xl text-gray-700 mb-8">Browse by region or search for a specific country</p>
                            
                            <!-- Search -->
                            <div class="flex flex-col sm:flex-row justify-center gap-2 max-w-lg mx-auto">
                                <input
                                    type="text"
                                    class="flex-1 px-6 py-4 rounded-full border-none outline-none shadow-lg text-lg focus:shadow-xl focus:scale-105 transition-all duration-300"
                                    placeholder="Search for a country..."
                                    :value="searchQuery"
                                    @input="$emit('search-change', $event.target.value)"
                                    @keypress="handleKeyPress"
                                />
                                <button
                                    @click="$emit('search')"
                                    class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-4 rounded-full hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex items-center justify-center gap-2"
                                >
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                    <span class="hidden sm:inline">Search</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </header>
            `,
            methods: {
                handleKeyPress(event) {
                    if (event.key === 'Enter') {
                        this.$emit('search');
                    }
                }
            }
        };

        // Country Card Component
        const CountryCard = {
            props: {
                country: {
                    type: Object,
                    required: true
                }
            },
            emits: ['show-details'],
            template: `
                <div class="bg-white/95 backdrop-blur-sm rounded-3xl p-6 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 border border-white/20 group">
                    <div class="w-full h-48 rounded-2xl overflow-hidden mb-4 shadow-lg">
                        <img
                            :src="country.flags?.svg || country.flags?.png"
                            :alt="'Flag of ' + country.name.common"
                            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                            @error="handleImageError"
                        />
                    </div>
                    
                    <h3 class="text-xl font-bold text-gray-800 mb-3 truncate" :title="country.name.common">
                        {{ country.name.common }}
                    </h3>
                    
                    <div class="flex items-center gap-2 text-gray-600 mb-2">
                        <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064"></path>
                        </svg>
                        <span class="truncate">Region: {{ country.region || 'N/A' }}</span>
                    </div>
                    
                    <div class="flex items-center gap-2 text-gray-600 mb-4">
                        <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                        <span class="truncate">Population: {{ formatPopulation(country.population) }}</span>
                    </div>
                    
                    <button
                        @click="$emit('show-details', country)"
                        class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-800 py-3 rounded-xl font-semibold hover:from-yellow-500 hover:to-yellow-400 hover:shadow-lg hover:-translate-y-1 transition-all duration-300"
                    >
                        More Info
                    </button>
                </div>
            `,
            methods: {
                formatPopulation(population) {
                    if (!population) return 'N/A';
                    return new Intl.NumberFormat().format(population);
                },
                handleImageError(event) {
                    event.target.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="60">üè≥Ô∏è</text></svg>';
                }
            }
        };

        // Pagination Component
        const PaginationComponent = {
            props: {
                currentPage: {
                    type: Number,
                    required: true
                },
                totalPages: {
                    type: Number,
                    required: true
                },
                totalItems: {
                    type: Number,
                    required: true
                },
                itemsPerPage: {
                    type: Number,
                    required: true
                }
            },
            emits: ['page-change'],
            computed: {
                startIndex() {
                    return (this.currentPage - 1) * this.itemsPerPage + 1;
                },
                endIndex() {
                    return Math.min(this.currentPage * this.itemsPerPage, this.totalItems);
                },
                visiblePages() {
                    const delta = 2;
                    const range = [];
                    
                    for (let i = Math.max(2, this.currentPage - delta);
                         i <= Math.min(this.totalPages - 1, this.currentPage + delta);
                         i++) {
                        range.push(i);
                    }
                    
                    return range;
                },
                showFirstEllipsis() {
                    return this.currentPage > 4;
                },
                showLastEllipsis() {
                    return this.currentPage < this.totalPages - 3;
                }
            },
            template: `
                <div class="flex flex-col items-center gap-4 mt-12">
                    <div class="text-white bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full border border-white/20">
                        Showing {{ startIndex }}-{{ endIndex }} of {{ totalItems }} countries
                    </div>
                    
                    <div class="flex items-center gap-2 flex-wrap justify-center">
                        <!-- Previous Button -->
                        <button
                            @click="$emit('page-change', currentPage - 1)"
                            :disabled="currentPage === 1"
                            class="px-4 py-2 bg-white/90 backdrop-blur-sm text-gray-700 rounded-xl font-semibold hover:bg-white hover:shadow-lg hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 disabled:hover:shadow-none"
                        >
                            ‚Üê Prev
                        </button>

                        <!-- First Page -->
                        <button
                            v-if="totalPages > 1"
                            @click="$emit('page-change', 1)"
                            :class="getPageButtonClass(1)"
                        >
                            1
                        </button>

                        <!-- First Ellipsis -->
                        <span v-if="showFirstEllipsis" class="text-white px-2 font-semibold">...</span>

                        <!-- Visible Pages -->
                        <button
                            v-for="page in visiblePages"
                            :key="page"
                            @click="$emit('page-change', page)"
                            :class="getPageButtonClass(page)"
                        >
                            {{ page }}
                        </button>

                        <!-- Last Ellipsis -->
                        <span v-if="showLastEllipsis" class="text-white px-2 font-semibold">...</span>

                        <!-- Last Page -->
                        <button
                            v-if="totalPages > 1 && currentPage < totalPages - 1"
                            @click="$emit('page-change', totalPages)"
                            :class="getPageButtonClass(totalPages)"
                        >
                            {{ totalPages }}
                        </button>

                        <!-- Next Button -->
                        <button
                            @click="$emit('page-change', currentPage + 1)"
                            :disabled="currentPage === totalPages"
                            class="px-4 py-2 bg-white/90 backdrop-blur-sm text-gray-700 rounded-xl font-semibold hover:bg-white hover:shadow-lg hover:-translate-y-1 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 disabled:hover:shadow-none"
                        >
                            Next ‚Üí
                        </button>
                    </div>
                </div>
            `,
            methods: {
                getPageButtonClass(page) {
                    const baseClass = 'px-4 py-2 rounded-xl font-semibold transition-all duration-300 min-w-[44px]';
                    if (this.currentPage === page) {
                        return baseClass + ' bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-800 shadow-lg -translate-y-1';
                    }
                    return baseClass + ' bg-white/90 backdrop-blur-sm text-gray-700 hover:bg-white hover:shadow-lg hover:-translate-y-1';
                }
            }
        };

        // Country Modal Component
        const CountryModal = {
            props: {
                country: {
                    type: Object,
                    default: null
                },
                isOpen: {
                    type: Boolean,
                    default: false
                }
            },
            emits: ['close'],
            template: `
                <div
                    v-if="isOpen && country"
                    class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in"
                    @click="$emit('close')"
                >
                    <div
                        class="bg-white rounded-3xl max-w-2xl w-full max-h-[80vh] overflow-y-auto animate-scale-in"
                        @click.stop
                    >
                        <!-- Header -->
                        <div class="p-6 border-b border-gray-100 relative">
                            <button
                                @click="$emit('close')"
                                class="absolute top-4 right-4 w-10 h-10 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors duration-200 z-10"
                            >
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                            
                            <img
                                :src="country.flags?.svg || country.flags?.png"
                                :alt="'Flag of ' + country.name.common"
                                class="w-full h-48 object-cover rounded-2xl mb-4 shadow-lg"
                            />
                            
                            <h2 class="text-3xl font-bold text-gray-800 pr-12">{{ country.name?.common }}</h2>
                        </div>
                        
                        <!-- Body -->
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="bg-gray-50 p-4 rounded-2xl border-l-4 border-blue-500">
                                    <div class="flex items-center gap-2 font-semibold text-gray-800 mb-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"></path>
                                        </svg>
                                        Official Name
                                    </div>
                                    <div class="text-gray-600">{{ country.name?.official || 'N/A' }}</div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-2xl border-l-4 border-green-500">
                                    <div class="flex items-center gap-2 font-semibold text-gray-800 mb-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064"></path>
                                        </svg>
                                        Languages
                                    </div>
                                    <div class="text-gray-600">{{ getLanguages(country.languages) }}</div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-2xl border-l-4 border-yellow-500">
                                    <div class="flex items-center gap-2 font-semibold text-gray-800 mb-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                        </svg>
                                        Currency
                                    </div>
                                    <div class="text-gray-600">{{ getCurrencies(country.currencies) }}</div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-2xl border-l-4 border-purple-500">
                                    <div class="flex items-center gap-2 font-semibold text-gray-800 mb-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        Timezones
                                    </div>
                                    <div class="text-gray-600">{{ getTimezones(country.timezones) }}</div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-2xl border-l-4 border-red-500">
                                    <div class="flex items-center gap-2 font-semibold text-gray-800 mb-2">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                        Region & Capital
                                    </div>
                                    <div class="text-gray-600">
                                        {{ country.region }}<span v-if="country.subregion"> - {{ country.subregion }}</span><br/>
                                        Capital: {{ getCapital(country.capital) }}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actions -->
                            <div class="flex flex-col sm:flex-row gap-4 mt-6">
                                <a
                                    v-if="country.maps?.googleMaps"
                                    :href="country.maps.googleMaps"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-xl font-semibold hover:shadow-lg hover:-translate-y-1 transition-all duration-300 flex items-center justify-center gap-2"
                                >
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                    View Maps
                                </a>
                                <button
                                    @click="$emit('close')"
                                    class="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-xl font-semibold hover:bg-gray-300 hover:-translate-y-1 transition-all duration-300"
                                >
                                    Okay
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `,
            methods: {
                getLanguages(languages) {
                    if (!languages) return 'N/A';
                    return Object.values(languages).join(', ');
                },
                getCurrencies(currencies) {
                    if (!currencies) return 'N/A';
                    return Object.values(currencies)
                        .map(currency => `${currency.name} (${currency.symbol || 'N/A'})`)
                        .join(', ');
                },
                getTimezones(timezones) {
                    if (!timezones || timezones.length === 0) return 'N/A';
                    return timezones.join(', ');
                },
                getCapital(capital) {
                    if (!capital || capital.length === 0) return 'N/A';
                    return capital.join(', ');
                }
            },
            mounted() {
                if (this.isOpen) {
                    document.body.style.overflow = 'hidden';
                }
            },
            beforeUnmount() {
                document.body.style.overflow = 'auto';
            },
            watch: {
                isOpen(newVal) {
                    if (newVal) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = 'auto';
                    }
                }
            }
        };

        // Main App
        createApp({
            components: {
                HeaderComponent,
                CountryCard,
                PaginationComponent,
                CountryModal
            },
            setup() {
                // Reactive state
                const countries = ref([]);
                const filteredCountries = ref([]);
                const loading = ref(true);
                const error = ref(null);
                const searchQuery = ref('');
                const selectedCountry = ref(null);
                const showModal = ref(false);
                const currentPage = ref(1);
                const itemsPerPage = ref(8);

                // Computed properties
                const totalPages = computed(() => {
                    return Math.ceil(filteredCountries.value.length / itemsPerPage.value);
                });

                const startIndex = computed(() => {
                    return (currentPage.value - 1) * itemsPerPage.value;
                });

                const endIndex = computed(() => {
                    return startIndex.value + itemsPerPage.value;
                });

                const paginatedCountries = computed(() => {
                    return filteredCountries.value.slice(startIndex.value, endIndex.value);
                });

                // Methods
                const fetchCountries = async () => {
                    try {
                        loading.value = true;
                        error.value = null;
                        
                        const fields = [
                            'name',
                            'flags',
                            'region',
                            'subregion',
                            'population',
                            'languages',
                            'currencies',
                            'timezones',
                            'capital',
                            'maps'
                        ];
                        
                        const response = await fetch(
                            `https://restcountries.com/v3.1/all?fields=${fields.join(',')}`
                        );
                        
                        if (!response.ok) {
                            throw new Error('Failed to fetch countries data');
                        }
                        
                        const data = await response.json();
                        const sortedData = data.sort((a, b) => 
                            a.name.common.localeCompare(b.name.common)
                        );
                        
                        countries.value = sortedData;
                        filteredCountries.value = sortedData;
                    } catch (err) {
                        error.value = err.message;
                        console.error('Error fetching countries:', err);
                    } finally {
                        loading.value = false;
                    }
                };

                const handleSearch = () => {
                    if (!searchQuery.value.trim()) {
                        filteredCountries.value = countries.value;
                    } else {
                        const query = searchQuery.value.toLowerCase().trim();
                        const filtered = countries.value.filter(country => 
                            country.name.common.toLowerCase().includes(query) ||
                            country.name.official?.toLowerCase().includes(query) ||
                            country.region?.toLowerCase().includes(query) ||
                            country.subregion?.toLowerCase().includes(query)
                        );
                        filteredCountries.value = filtered;
                    }
                    currentPage.value = 1;
                };

                const handleSearchChange = (query) => {
                    searchQuery.value = query;
                    // Auto-search on input change with debouncing
                    if (!query.trim()) {
                        filteredCountries.value = countries.value;
                        currentPage.value = 1;
                    }
                };

                const showCountryDetails = (country) => {
                    selectedCountry.value = country;
                    showModal.value = true;
                };

                const closeModal = () => {
                    showModal.value = false;
                    selectedCountry.value = null;
                };

                const handlePageChange = (page) => {
                    if (page >= 1 && page <= totalPages.value) {
                        currentPage.value = page;
                        // Smooth scroll to top
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                };

                // Watchers
                let searchTimeout;
                watch(searchQuery, (newQuery) => {
                    if (searchTimeout) clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        if (newQuery) {
                            handleSearch();
                        }
                    }, 300);
                });

                // Lifecycle
                onMounted(() => {
                    fetchCountries();
                });

                return {
                    // State
                    countries,
                    filteredCountries,
                    loading,
                    error,
                    searchQuery,
                    selectedCountry,
                    showModal,
                    currentPage,
                    itemsPerPage,
                    // Computed
                    totalPages,
                    paginatedCountries,
                    // Methods
                    handleSearch,
                    handleSearchChange,
                    showCountryDetails,
                    closeModal,
                    handlePageChange
                };
            }
        }).mount('#app');
    </script>
</body>
</html>